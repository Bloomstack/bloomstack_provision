---
# tasks file for docker_setup
- name: Create a db directory if it does not exist  # creating directory of rds
  file:
    path: '{{ frappe_home }}/docker'
    state: directory
  become_user: '{{ user_name }}'
- name: Download docker.sh
  get_url:
    url: https://get.docker.com
    dest: '{{ frappe_home }}/docker/get-docker.sh'
    mode: '0755'
- name: Execute the script
  command: 'sh {{ frappe_home }}/docker/get-docker.sh'
  become: true
- name: Execute the script
  command: 'usermod -aG docker {{ user_name }}'
  become: true
- name: installing bench from pip3
  pip:
    name: "{{ item }}"
    executable: pip3
  with_items:
    - "docker-compose"
  become: yes
- name: Download foo.conf
  get_url:
    url: https://github.com/chaifeng/ufw-docker/raw/master/ufw-docker
    dest: /usr/local/bin/ufw-docker
    mode: '0755'
- name: ufw-docker install
  shell: 'ufw-docker install'
  become: yes

- name: doing docker-compose
  import_tasks: docker_compose.yml
